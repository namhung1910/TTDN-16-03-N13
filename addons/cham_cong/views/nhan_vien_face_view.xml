<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Wizard action for camera - MUST BE DEFINED FIRST -->
    <record id="action_camera_wizard" model="ir.actions.client">
        <field name="name">Camera ƒêƒÉng K√Ω</field>
        <field name="tag">face_camera_widget</field>
        <field name="target">new</field>
    </record>
    
    <!-- Extend nhan_vien form view v·ªõi Face Recognition tab -->
    <record id="view_nhan_vien_face_form" model="ir.ui.view">
        <field name="name">nhan_vien.face.form</field>
        <field name="model">nhan_vien</field>
        <field name="inherit_id" ref="nhan_su.view_nhan_vien_form"/>
        <field name="arch" type="xml">
            <xpath expr="//notebook" position="inside">
                <page string="Nh·∫≠n Di·ªán Khu√¥n M·∫∑t" name="face_recognition">
                    <group>
                        <group string="Th√¥ng Tin ƒêƒÉng K√Ω">
                            <field name="face_registered" readonly="1" 
                                   widget="boolean" 
                                   string="ƒê√£ ƒëƒÉng k√Ω"/>
                            <field name="face_registered_date" readonly="1" 
                                   attrs="{'invisible': [('face_registered', '=', False)]}"/>
                        </group>
                        <group string="·∫¢nh Khu√¥n M·∫∑t">
                            <field name="face_image" widget="image" 
                                   options="{'size': [200, 200]}"
                                   attrs="{'invisible': [('face_registered', '=', False)]}"/>
                        </group>
                    </group>
                    
                    <separator string="ƒêƒÉng K√Ω Khu√¥n M·∫∑t"/>
                    <group>
                        <div class="oe_button_box" style="text-align: center; margin: 20px 0;">
                            <button name="%(action_camera_wizard)d" 
                                    string="üì∑ ƒêƒÉng K√Ω Khu√¥n M·∫∑t"
                                    type="action"
                                    class="btn-primary oe_highlight"
                                    icon="fa-camera"
                                    attrs="{'invisible': [('face_registered', '=', True)]}"/>
                            
                            <button name="%(action_camera_wizard)d" 
                                    string="üîÑ C·∫≠p Nh·∫≠t Khu√¥n M·∫∑t"
                                    type="action"
                                    class="btn-warning"
                                    icon="fa-refresh"
                                    attrs="{'invisible': [('face_registered', '=', False)]}"/>
                        </div>
                    </group>
                    
                    <group string="H∆∞·ªõng D·∫´n">
                        <div class="alert alert-info" role="alert">
                            <strong>üìù L∆∞u √Ω khi ƒëƒÉng k√Ω:</strong>
                            <ul>
                                <li>Ch·ªâ c√≥ 1 ng∆∞·ªùi trong ·∫£nh</li>
                                <li>√Ånh s√°ng ƒë·ªß, m·∫∑t r√µ r√†ng</li>
                                <li>Nh√¨n th·∫≥ng v√†o camera</li>
                                <li>Kh√¥ng ƒëeo kh·∫©u trang ho·∫∑c k√≠nh ƒëen</li>
                            </ul>
                        </div>
                    </group>
                </page>
            </xpath>
        </field>
    </record>
    
    <!-- Extend nhan_vien tree view v·ªõi Face ID indicator -->
    <record id="view_nhan_vien_face_tree" model="ir.ui.view">
        <field name="name">nhan_vien.face.tree</field>
        <field name="model">nhan_vien</field>
        <field name="inherit_id" ref="nhan_su.view_nhan_vien_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="face_registered" 
                       widget="boolean" 
                       string="Face ID"
                       optional="show"/>
            </xpath>
        </field>
    </record>
</odoo>
